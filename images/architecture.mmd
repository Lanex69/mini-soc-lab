flowchart LR

  %% Internal network zone
  subgraph InternalNetwork["Internal Network (Isolated)"]
    A["Parrot Attacker"]
    B["Windows 10 Victim (Sysmon + Wazuh Agent)"]
    Z["Zeek Sensor"]
    WA["Wazuh Agent"]
    A -->|Attack traffic| B
    A -->|Probes| Z
    B -->|Sysmon events| WA
  end

  %% SIEM zone with dual NIC explanation
  subgraph SIEM["SIEM VM (Xubuntu)"]
    direction TB
    note1["Primary NIC: Internal Network"]
    note2["Secondary NIC: NAT (Internet)"]
    W["Wazuh Manager"]
    E["Elastic Stack (Elasticsearch + Kibana)"]
    W -->|Send alerts| E
    note1 --- W
    note2 --- E
  end

  %% Data flows
  Z -->|"Zeek logs (conn/http/dns)"| E
  WA -->|Agent alerts| W

  %% Internet connectivity
  Internet((Internet))
  SIEM -. NAT traffic .-> Internet
